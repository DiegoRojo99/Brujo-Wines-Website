<!DOCTYPE html>
<html lang="es">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
 
	<!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.css" />

	<meta name="author" content="Diego Rojo">
	<title>Brujo Wines</title>

</head>
<body>
  <div>
      <img id="header-photo" src="img/bodega/600m-altura.png">
      <header class="header">
          <nav class="navbar">
              <a href="index.html" class="nav-logo">
                  <img src="./img/logo.png">
              </a>
              <ul class="nav-menu">
                  <li class="nav-item">
                      <a href="vinos.html" class="nav-link">Vinos</a>
                  </li>
                  <li class="nav-item">
                      <a href="galeria.html" class="nav-link">Galeria</a>
                  </li>
                  <li class="nav-item">
                      <a href="reservas.html" class="nav-link">Reservas</a>
                  </li>
                  <li class="nav-item">
                      <a id="boton-mostrar-formulario" href="#" class="nav-link">Log-In</a>
                  </li>
              </ul>
              <div class="hamburger">
                  <span class="bar"></span>
                  <span class="bar"></span>
                  <span class="bar"></span>
              </div>
          </nav>
      </header>
  </div>

  <div id="form-to-use" class="forms-out" style="display: none;">
    <i id="x-icon">
      X
    </i>
    <div class="forms-in">
      <div id="registration-page" class="hide">
        <h3>Registrarse</h3>
        Email <br />
        <input type="email" id="registration-email" /><br />
        Confirme Email <br />
        <input
          type="email"
          id="registration-reemail"
          autocomplete="disable"
        /><br />
        Contraseña <br />
        <input type="password" id="registration-password" /><br />
    
        <p id="ya-registrado">¿Ya estás registrado?</p>
        <button id="register">Registrarse</button>
      </div>

      <div id="login-page">
        <h3>Iniciar Sesión</h3>
        Email <br />
        <input type="email" id="login-email" /><br />
        Password <br />
        <input type="password" id="login-password" /><br />
        <p id="forgot-password">¿Contraseña Olvidada?</p>
        <p id="todavia-no-registrado">¿Todavía no estás registrado?</p>
        <button id="login">Iniciar Sesión</button>
      </div>

      <div id="homepage" class="hide">
        <h3>Sesión Iniciada</h3>
        <button id="signout">Cerrar Sesión</button>
      </div>
    </div>
  </div>

  <div class="coleccion-fotos">
    <h3>Nuestras Fotos</h3>
    <div class="responsive-gallery">
      <div class="gallery">
        <a target="_blank" href="img/bodega/san-vicente.png">
          <img src="img/bodega/san-vicente.png" alt="Foto San Vicente" width="600" height="400">
        </a>
        <div class="desc">
          San Vicente de la Sonsierra
        </div>
      </div>
    </div>
    <div class="responsive-gallery">
      <div class="gallery">
        <a target="_blank" href="img/bodega/barricas.jpg">
          <img style="object-fit: cover;" src="img/bodega/barricas.jpg" alt="Barricas" width="600" height="400">
        </a>
        <div class="desc">Barricas de Titania</div>
      </div>
    </div>
    <div class="responsive-gallery">
      <div class="gallery">
        <a target="_blank" href="img/bodega/600m-altura.png">
          <img src="img/bodega/600m-altura.png" alt="Foto Viña 3" width="600" height="400">
        </a>
        <div class="desc">Nuestros Viñedos</div>
      </div>
    </div>
    <div class="responsive-gallery">
      <div class="gallery">
        <a target="_blank" href="img/bodega/cabecera-somos-brujo-wines-1.png">
          <img src="img/bodega/cabecera-somos-brujo-wines-1.png" alt="Foto Viña 1" width="600" height="400">
        </a>
        <div class="desc">Viñedos de cerca</div>
      </div>
    </div>
    <div class="responsive-gallery">
      <div class="gallery">
        <a target="_blank" href="img/bodega/fondo-equilibrio.png">
          <img src="img/bodega/fondo-equilibrio.png" alt="Foto Viña 2" width="600" height="400">
        </a>
        <div class="desc">Foto 5</div>
      </div>
    </div>
    <div class="responsive-gallery">
      <div class="gallery">
        <a target="_blank" href="img/bodega/parra-uva.png">
          <img src="img/bodega/parra-uva.png" alt="Foto Viña 3" width="600" height="400">
        </a>
        <div class="desc">Foto 6</div>
      </div>
    </div>
    <div class="responsive-gallery">
      <div class="gallery">
        <a target="_blank" href="img/bodega/vinedos-montana.png">
          <img src="img/bodega/vinedos-montana.png" alt="Foto Viña 3" width="600" height="400">
        </a>
        <div class="desc">Nuestros viñedos entre montañas</div>
      </div>
    </div>
    <div class="responsive-gallery">
      <div class="gallery">
        <a target="_blank" href="img/videos/brujolaser.mp4">
          <video autoplay controls>
            <source type="video/mp4" src="img/bodega/brujolaser.mp4">
          </video>
        </a>
        <div class="desc">Grabación de nuestro logo en la barrica</div>
      </div>
    </div>
  </div>

  <footer>
    <img id="FooterLogo" src="img/logo-marron.svg">
    <br>
    <hr class="linea-hr"/>
    <br>

    <div id="redes-sociales">
    <h6>Nuestras Redes Sociales</h6>
    <ul id="FooterList">
        <il class="FooterItem"><a href=""><i class="fa-brands fa-whatsapp"></i></a></il>
        <il class="FooterItem"><a href=""><i class="fa-brands fa-facebook-f"></i></a></il>
        <il class="FooterItem"><a href=""><i class="fa-brands fa-instagram"></i></a></il>
        <il class="FooterItem"><a href=""><i class="fa-brands fa-twitter"></i></a></il>
    </ul>
    </div>
    
    <div id="google-maps">
      <div class="mapouter">
        <div class="gmap_canvas">
          <iframe width="700" height="200" id="gmap_canvas" 
          src="https://maps.google.com/maps?q=san%20vicente%20de%20la%20sonsierra&t=&z=13&ie=UTF8&iwloc=&output=embed" 
          frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe><br>
        </div>
      </div>
    </div>
    
    <div id="footer-horas-desc">
    <h3>Visita Brujo Wines</h3>
    <div id="salon-catas">
        <h6>Salon de Catas</h6>
        <p>Horas 10:00-18:00</p>
        <p>Direccion Linea 1<br>Direccion Linea 2<br>Direccion Linea 3</p>
    </div>
    <div id="visita-bodega">
        <h6>Visita a la Bodega</h6>
        <p>Horas 10:00-18:00</p>
        <p>Direccion Linea 1<br>Direccion Linea 2<br>Direccion Linea 3</p>
    </div>
    </div>
  </footer>

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-app.js"></script>
    <!-- TODO: Add SDKs for Firebase products that you want to use-->
    <script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-auth.js"></script>
    <script>
      // Your web app's Firebase configuration
      var firebaseConfig = {
        apiKey: "AIzaSyBqFvsjkgTdQuinpZhAWLKPcghZa4gk0eU",
        authDomain: "brujowines.firebaseapp.com",
        databaseURL: "https://brujowines-default-rtdb.firebaseio.com",
        projectId: "brujowines",
        storageBucket: "brujowines.appspot.com",
        messagingSenderId: "1017605599237",
        appId: "1:1017605599237:web:8faf234b61927b164eac6c",
        measurementId: "G-NW2R0GGXKB"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
    </script>
    <script>
      //invokes firebase authentication.
      const auth = firebase.auth();

      document.querySelector("#todavia-no-registrado").addEventListener("click", () => {
        showRegistration();
      });

      const showRegistration = () => {
        document.querySelector("#registration-page").classList.remove("hide");
        document.querySelector("#login-page").classList.add("hide");
        document.querySelector("#homepage").classList.add("hide");
      };

      document.querySelector("#ya-registrado").addEventListener("click", () => {
        showLogin();
      });

      const showLogin = () => {
        document.querySelector("#registration-page").classList.add("hide");
        document.querySelector("#login-page").classList.remove("hide");
        document.querySelector("#homepage").classList.add("hide");
      };

      document.querySelector("#signout").addEventListener("click", () => {
        signOut();
      });

      const register = () => {
        const email = document.querySelector("#registration-email").value;
        const reemail = document.querySelector("#registration-reemail").value;
        const password = document.querySelector("#registration-password").value;

        if (email.trim() == "") {
          alert("Introduzca el email");
        } else if (password.trim().length < 6) {
          alert("La contraseña tiene que ser de al menos 6 caracteres");
        } else if (email != reemail) {
          alert("Los correos no coinciden");
        } else {
          auth
            .createUserWithEmailAndPassword(email, password)
            .catch(function (error) {
              // Handle Errors here.
              var errorCode = error.code;
              var errorMessage = error.message;
              alert(errorMessage);
              // ...
            });
        }
      };

      document.querySelector("#register").addEventListener("click", () => {
        register();
      });

      //register when you hit the enter key
      document
        .querySelector("#registration-password")
        .addEventListener("keyup", (e) => {
          if (event.keyCode === 13) {
            e.preventDefault();

            register();
          }
        });

      const login = () => {
        const email = document.querySelector("#login-email").value;
        const password = document.querySelector("#login-password").value;

        if (email.trim() == "") {
          alert("Introduzca el email");
        } else if (password.trim() == "") {
          alert("Introduzca la contraseña");
        } else {
          authenticate(email, password);
        }
      };

      document.querySelector("#login").addEventListener("click", () => {
        login();
      });

      //Iniciar Sesión when you hit enter
      document
        .querySelector("#login-password")
        .addEventListener("keyup", (e) => {
          if (event.keyCode === 13) {
            e.preventDefault();

            login();
          }
        });

      const authenticate = (email, password) => {
        const auth = firebase.auth();
        auth.signInWithEmailAndPassword(email, password);
        firebase
          .auth()
          .signInWithEmailAndPassword(email, password)
          .catch(function (error) {
            // Handle Errors here.
            var errorCode = error.code;
            var errorMessage = error.message;
            alert(errorMessage);
          });
      };

      const showHomepage = () => {
        document.querySelector("#registration-page").classList.add("hide");
        document.querySelector("#login-page").classList.add("hide");
        document.querySelector("#homepage").classList.remove("hide");
      };

      const signOut = () => {
        firebase
          .auth()
          .signOut()
          .then(function () {
            location.reload();
          })
          .catch(function (error) {
            alert("Error al cerrar sesión, compruebe la conexión");
          });
      };

      auth.onAuthStateChanged((firebaseUser) => {
        if (firebaseUser) {
          showHomepage();
        }
      });

      document
        .querySelector("#forgot-password")
        .addEventListener("click", () => {
          const email = document.querySelector("#login-email").value;
          if (email.trim() == "") {
            alert("Introduzca el email");
          } else {
            forgotPassword(email);
          }
        });

      const forgotPassword = (email) => {
        auth
          .sendPasswordResetEmail(email)
          .then(function () {
            alert("El email ha sido enviado");
          })
          .catch(function (error) {
            alert("Hay un error. Compruebe su email o su conexión.");
          });
      };
    </script>
    <script src="./js/menu.js"></script>
    <script src="./js/loggingForm.js"></script>
    <script src="https://kit.fontawesome.com/0fa11aa035.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
</body>

</html>